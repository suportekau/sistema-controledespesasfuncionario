<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login K-Sistemas</title>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f0f0f0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    margin: 0;
  }

  .login-box {
    background-color: white;
    padding: 30px;
    border-radius: 8px;
    box-shadow: 0 0 15px rgba(0,0,0,0.3);
    width: 320px;
    position: relative;
  }

  .top-left {
    position: absolute;
    top: 10px;
    left: 10px;
    font-weight: bold;
    font-size: 10px;
    color: #333;
  }

  h2 {
    text-align: center;
    margin-bottom: 20px;
  }

  input {
    width: 100%;
    padding: 10px 40px 10px 10px;
    margin-bottom: 10px;
    font-size: 16px;
    text-transform: uppercase;
    border: 1px solid #ccc;
    border-radius: 4px;
    box-sizing: border-box;
  }

  .senha-container {
    position: relative;
  }

  .toggle-senha {
    position: absolute;
    right: 10px;
    top: 50%;
    transform: translateY(-50%);
    cursor: pointer;
    background: none;
    border: none;
    padding: 0;
    color: #333;
    font-size: 20px;
  }

  button.entrar {
    width: 100%;
    padding: 10px;
    background-color: #333;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
  }

  button.entrar:hover {
    background-color: #555;
  }

  .mensagem {
    text-align: center;
    margin-bottom: 10px;
    font-weight: bold;
    height: 20px;
    transition: all 0.3s;
  }

  .erro {
    color: white;
    background-color: #f44336;
    padding: 5px;
    border-radius: 4px;
  }

  .sucesso {
    color: white;
    background-color: #4CAF50;
    padding: 5px;
    border-radius: 4px;
  }
</style>
</head>
<body>

<div class="login-box">
  <div class="top-left">K-Sistemas</div>
  <h2>Login</h2>
  <div class="mensagem" id="mensagem"></div>

  <form id="loginForm">
    <input type="text" id="usuario" placeholder="Usuário" autocomplete="off" required>
    <div class="senha-container">
      <input type="password" id="senha" placeholder="Senha" required>
      <button type="button" class="toggle-senha">
        <span class="material-icons" id="icone-olho">visibility</span>
      </button>
    </div>
    <button type="submit" class="entrar">Entrar</button>
  </form>
</div>

<script type="module">
// ===== Variáveis =====
const usuario = document.getElementById('usuario');
const senha = document.getElementById('senha');
const toggleSenha = document.querySelector('.toggle-senha');
const iconeOlho = document.getElementById('icone-olho');
const form = document.getElementById('loginForm');
const mensagem = document.getElementById('mensagem');

// ===== Foco automático =====
window.addEventListener('load', () => usuario.focus());

// ===== Letras maiúsculas =====
[usuario, senha].forEach(input => {
  input.addEventListener('input', () => input.value = input.value.toUpperCase());
});

// ===== Enter muda de campo ou envia =====
usuario.addEventListener('keydown', e => { if(e.key==='Enter'){ e.preventDefault(); senha.focus(); } });
senha.addEventListener('keydown', e => { if(e.key==='Enter'){ e.preventDefault(); form.requestSubmit(); } });

// ===== Mostrar / ocultar senha =====
toggleSenha.addEventListener('click', () => {
  if(senha.type === 'password') {
    senha.type = 'text';
    iconeOlho.textContent = 'visibility_off';
  } else {
    senha.type = 'password';
    iconeOlho.textContent = 'visibility';
  }
});

// ===== Função para mostrar mensagem =====
function mostrarMensagem(texto, tipo) {
  mensagem.textContent = texto;
  mensagem.className = `mensagem ${tipo}`;
  setTimeout(() => {
    mensagem.textContent = '';
    mensagem.className = 'mensagem';
  }, 2000);
}

// ===== Login fictício =====
form.addEventListener('submit', e => {
  e.preventDefault();
  if(usuario.value.trim() === "ADMIN" && senha.value.trim() === "1234") {
    mostrarMensagem("Login correto!", "sucesso");
    setTimeout(() => { window.location.href = "menu.html"; }, 1000);
  } else {
    mostrarMensagem("Usuário ou senha incorretos!", "erro");
    form.reset();
    usuario.focus();
  }
});

// ===== Login Firebase =====
import { auth } from "./firebase.js";
import { signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";

form.addEventListener('submit', async e => {
  e.preventDefault();
  const email = usuario.value.trim() + "@empresa.com";
  const password = senha.value.trim();

  try {
    await signInWithEmailAndPassword(auth, email, password);
    mostrarMensagem("Login correto!", "sucesso");
    setTimeout(() => { window.location.href = "menu.html"; }, 1000);
  } catch (error) {
    mostrarMensagem("Usuário ou senha incorretos!", "erro");
    form.reset();
    usuario.focus();
  }
});
</script>

</body>
</html>
